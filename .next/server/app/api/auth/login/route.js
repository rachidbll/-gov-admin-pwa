"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")},2761:e=>{e.exports=require("node:async_hooks")},7718:e=>{e.exports=require("node:child_process")},6005:e=>{e.exports=require("node:crypto")},5673:e=>{e.exports=require("node:events")},7561:e=>{e.exports=require("node:fs")},3977:e=>{e.exports=require("node:fs/promises")},612:e=>{e.exports=require("node:os")},9411:e=>{e.exports=require("node:path")},7742:e=>{e.exports=require("node:process")},5997:e=>{e.exports=require("node:tty")},7261:e=>{e.exports=require("node:util")},1017:e=>{e.exports=require("path")},1453:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>g,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>h,staticGenerationAsyncStorage:()=>x});var i={};t.r(i),t.d(i,{POST:()=>l});var o=t(9303),a=t(8716),s=t(670),n=t(7070),p=t(2331),u=t(8691),d=t(3543);async function l(e){try{let{email:r,password:t,type:i}=await e.json();if("email"===i){if(!r||!t)return n.NextResponse.json({error:"Email and password are required"},{status:400});let e=await p._.user.findUnique({where:{email:r}});if(!e||!await u.ZP.compare(t,e.password))return n.NextResponse.json({error:"Invalid credentials"},{status:401});await p._.user.update({where:{id:e.id},data:{lastLogin:new Date}});let i=Buffer.from(e.id).toString("base64"),o=(0,d.qC)("auth_token",i,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:604800,path:"/"});return new n.NextResponse(JSON.stringify({success:!0,user:{id:e.id,name:e.name,email:e.email,role:e.role,createdAt:e.createdAt,updatedAt:e.updatedAt,lastLogin:e.lastLogin,isDefaultPassword:e.isDefaultPassword}}),{status:200,headers:{"Set-Cookie":o,"Content-Type":"application/json"}})}if("government"===i)return n.NextResponse.json({error:"Government ID login not yet implemented"},{status:501});return n.NextResponse.json({error:"Invalid login type"},{status:400})}catch(e){return console.error("Login error:",e),n.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Gemnini\\gov-admin-pwa\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:c,staticGenerationAsyncStorage:x,serverHooks:h}=m,f="/api/auth/login/route";function g(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:x})}},3543:(e,r)=>{r.qC=function(e,r,n){let p=n?.encode||encodeURIComponent;if(!t.test(e))throw TypeError(`argument name is invalid: ${e}`);let u=p(r);if(!i.test(u))throw TypeError(`argument val is invalid: ${r}`);let d=e+"="+u;if(!n)return d;if(void 0!==n.maxAge){if(!Number.isInteger(n.maxAge))throw TypeError(`option maxAge is invalid: ${n.maxAge}`);d+="; Max-Age="+n.maxAge}if(n.domain){if(!o.test(n.domain))throw TypeError(`option domain is invalid: ${n.domain}`);d+="; Domain="+n.domain}if(n.path){if(!a.test(n.path))throw TypeError(`option path is invalid: ${n.path}`);d+="; Path="+n.path}if(n.expires){var l;if(l=n.expires,"[object Date]"!==s.call(l)||!Number.isFinite(n.expires.valueOf()))throw TypeError(`option expires is invalid: ${n.expires}`);d+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(d+="; HttpOnly"),n.secure&&(d+="; Secure"),n.partitioned&&(d+="; Partitioned"),n.priority)switch("string"==typeof n.priority?n.priority.toLowerCase():void 0){case"low":d+="; Priority=Low";break;case"medium":d+="; Priority=Medium";break;case"high":d+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":d+="; SameSite=Strict";break;case"lax":d+="; SameSite=Lax";break;case"none":d+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${n.sameSite}`)}return d};let t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,i=/^[\u0021-\u003A\u003C-\u007E]*$/,o=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[948,972,691,331],()=>t(1453));module.exports=i})();